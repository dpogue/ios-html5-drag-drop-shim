/*! drag-drop-webkit-mobile 0.2.4 | Copyright (c) 2014 Tim Ruffles | BSD 2 License */!function(a,b){"use strict";function c(){var a=b.createElement("div"),c="draggable"in a,d="ondragstart"in a&&"ondrop"in a,f=!(c||d)||/iPad|iPhone|iPod/.test(navigator.userAgent);l((f?"":"not ")+"patching html5 drag drop"),f&&b.addEventListener("touchstart",e)}function d(a,b){this.touchPositions={},this.dragData={},this.el=b||a.target,this.isClick=!0,a.preventDefault(),l("dragstart"),this.dispatchDragEvent("dragstart",this.el),this.elTranslation=g(this.el);var c=this.el.style["-webkit-transform"].replace(/scale\(\D*\d+[^,]*\)/,"");this.el.style["-webkit-transform"]=c+" scale(2)",this.listen()}function e(a){var c=a.target;do"true"===c.getAttribute("draggable")&&(a.preventDefault(),new d(a,c));while((c=c.parentNode)&&c!==b.body&&c!==b)}function f(c,d){c.style.pointerEvents="none";var e=d.changedTouches[0],f=b.elementFromPoint(e.pageX-a.pageXOffset,e.pageY-a.pageYOffset);return c.style.pointerEvents="",f}function g(a){var b=a.style["-webkit-transform"],c=0,d=0,e=/translate\(\s*(\d+)[^,]*,\D*(\d+)/.exec(b);return e&&(c=parseInt(e[1],10),d=parseInt(e[2],10)),{x:c,y:d}}function h(a,b,c){var d=a.style["-webkit-transform"].replace(/translate3d\(\D*\d+[^,]*,\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,"");d=d.replace("scale(2)",""),a.style["-webkit-transform"]=d+" translate3d("+b+"px,"+c+"px, 1px) scale(2)"}function i(a){var b=a.style["-webkit-transform"].replace(/translate3d\(\D*\d+[^,]*,\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,"");a.style["-webkit-transform"]=b.replace("scale(2)","")}function j(a,b,c,d){return d&&(c=c.bind(d)),a.addEventListener(b,c),{off:function(){return a.removeEventListener(b,c)}}}function k(a,b,c,d){function e(d){return c(d),a.removeEventListener(b,e)}return d&&(c=c.bind(d)),a.addEventListener(b,e)}function l(a){console.log(a)}function m(a){return 0===a.length?0:a.reduce(function(a,b){return b+a},0)/a.length}l=function(){},c(),d.prototype={listen:function(){function a(a){this.isClick?this.click(a):this.dragend(a),c.bind(this)()}function c(){return l("cleanup"),this.touchPositions={},this.dragData=null,[d,e,f].forEach(function(a){return a.off()})}var d=j(b,"touchmove",this.move,this),e=j(b,"touchend",a,this),f=j(b,"touchcancel",c,this)},move:function(a){var b={x:[],y:[]};a.preventDefault(),[].forEach.call(a.changedTouches,function(a,c){var d=this.touchPositions[c];d?(b.x.push(a.pageX-d.x),b.y.push(a.pageY-d.y)):this.touchPositions[c]=d={},d.x=a.pageX,d.y=a.pageY}.bind(this)),this.elTranslation.x+=m(b.x),this.elTranslation.y+=m(b.y),h(this.el,this.elTranslation.x,this.elTranslation.y),(this.elTranslation.x>=5||this.elTranslation.x<=-5||this.elTranslation.y>=5||this.elTranslation.y<=-5)&&(this.isClick=!1);var c=f(this.el,a);null!==c&&(c!==this.prevTarget&&(void 0!==this.prevTarget&&this.dispatchDragEvent("dragleave",this.prevTarget),this.dispatchDragEvent("dragenter",c),this.prevTarget=c),this.dispatchDragEvent("dragover",c))},click:function(){l("click"),i(this.el);var a=b.createEvent("MouseEvents");a.initEvent("click",!0,!0),this.el.dispatchEvent(a)},dragend:function(a){l("dragend");var c=f(this.el,a);c?(l("found drop target "+c.tagName),this.dispatchDrop(c)):(l("no drop target, scheduling snapBack"),k(b,"dragend",this.snapBack,this));var d=b.createEvent("Event");d.initEvent("dragend",!0,!0),this.el.dispatchEvent(d)},dispatchDrop:function(a){var c=!0,d=b.createEvent("Event");d.initEvent("drop",!0,!0),d.dataTransfer={getData:function(a){return this.dragData[a]}.bind(this)},d.preventDefault=function(){c=!1,i(this.el)}.bind(this),k(b,"drop",function(){l("drop event not canceled"),c&&this.snapBack()},this),a.dispatchEvent(d)},snapBack:function(){k(this.el,"webkitTransitionEnd",function(){this.el.style["-webkit-transition"]="none",i(this.el)},this),setTimeout(function(){this.el.style["-webkit-transition"]="all 0.2s",h(this.el,0,0)}.bind(this))},dispatchDragEvent:function(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.dataTransfer={setData:function(a,b){this.dragData[a]=b}.bind(this),dropEffect:"move"},c.dispatchEvent(d)}},void 0===Function.prototype.bind&&(Function.prototype.bind=function(b){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - binding an object that is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:b||a,c.concat(Array.prototype.slice.call(arguments)))};return e.prototype=this.prototype,f.prototype=new e,f})}(window,document);